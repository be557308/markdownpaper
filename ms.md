---
title: Neural Signatures of Reward and Sensory Prediction Error in Motor Learning
author:
 - name: Dimitrios J. Palidis
   affiliation: 1,2,3
 - name: Joshua G.A. Cashaback
   affiliation: 1,2
 - name: Paul L. Gribble
   affiliation: 1,2,4,5
   email: paul@gribblelab.org
organization:
 - id: 1
   name: The Brain and Mind Institute, Western University
   address: London, ON, Canada
 - id: 2
   name: Dept. Psychology, Western University
   address: London, ON, Canada
 - id: 3
   name: Graduate Program in Neuroscience, Schulich School of Medicine & Dentistry, Western University
   address: London, ON, Canada
 - id: 4
   name: Dept. Physiology & Pharmacology, Schulich School of Medicine & Dentistry, Western University
   address: London, ON, Canada
 - id: 5
   name: Haskins Laboratories
   address: New Haven, CT, USA
keywords: motor adaptation, prediction error, P300, feedback related negativity, reward
short_title: Prediction Error in Motor Adaptation
date: June 10, 2018
bibliography: refs.bib
---

\newpage
# Abstract

Two distinct processes contribute to changes in motor commands during reach adaptation: reward based learning and sensory error based learning. In sensory error based learning, the mapping between sensory targets and motor commands is recalibrated according to sensory error feedback. In reward based learning, motor commands are associated with subjective value, such that successful actions are reinforced. We recorded EEG from humans to identify and dissociate the neural correlates of reward prediction error (RPE) and sensory prediction error (SPE) during learning tasks designed to isolate each response. We designed a visuomotor rotation task to isolate sensory error based learning in response to SPE, which was induced by altered visual feedback of hand position. In a reward learning task, we isolated learning in response to RPE induced by binary reward feedback that was decoupled from the visual target. We found that a fronto-central event related potential called the feedback related negativity (FRN) occurred specifically in response to RPE during reward based learning. A more posterior component called the P300 was evoked by feedback in both tasks. In the visuomotor rotation task, P300 amplitude was increased by SPE and was correlated with learning rate, while in the reward learning task P300 amplitude was increased by reward relative to non reward and by surprise regardless of feedback valence. We suggest that the FRN specifically marks RPE while the P300 reflects more general processing of prediction error.

# New and Noteworthy

We studied the event related potentials evoked by feedback stimuli during motor adaptation tasks that isolate reward and sensory error learning mechanisms. We found that the feedback related negativity was specifically elicited by reward prediction error, while the P300 reflected prediction error generally and was observed in both tasks. These results reveal neural processes associated with different learning mechanisms and elucidate which classes of errors, from a computational standpoint, elicit the FRN and P300.

\newpage
# Introduction

It is thought that sensorimotor adaptation is driven by two distinct error signals, sensory prediction error (SPE) and reward prediction error (RPE), and that both can simultaneously contribute to learning [@Huang2011-hm; @Izawa2011-ik; @Shmuelof2012-yr; @Galea2015-hx; @Nikooyan2015-cn]. EEG has been used to identify neural signatures of error processing in various motor learning and movement execution tasks, but it remains unclear how these neural responses relate to distinct reward and sensory-error based motor learning mechanisms [@Krigolson2008-dh; @Torrecillos2014-jd; @MacLean2015-sv]. Here we identified neural signatures of SPE and RPE in motor learning using separate learning paradigms that produce comparable changes in behavior.

SPE occurs when the sensory consequences of motor commands differ from the expected outcomes. SPEs can be imposed in experimental visuomotor rotation (VMR) paradigms by rotating visual feedback of hand position relative to the actual angle of reach. Adaptation, in which motor output is adjusted to compensate for perturbations, is thought to be driven primarily by SPE in these tasks [@Izawa2011-ik; @Marko2012-wb]. Sensory error feedback activates brain regions including primary sensory motor areas, posterior parietal cortex, and cerebellum [@Inoue2000-op; @Krakauer2004-za; @Diedrichsen2005-wa; @Bedard2014-qq]. @Tanaka2009-gp propose that SPEs computed by the cerebellum produce adaptation via changes in synaptic weighting between the posterior parietal cortex and motor cortex.

Recent research suggests that a reward based learning process can also contribute to motor adaptation in parallel to a sensory-error based learning system, and that reward feedback can drive motor learning even in the absence of sensory error feedback [@Izawa2011-ik]. Reward learning has been isolated experimentally by providing participants with only binary reward feedback, without visual feedback of hand position. Reward-based motor learning has been modelled as reinforcement learning, which maps actions to abstract representations of reward or success, rather than to the sensory consequences of action. In reinforcement learning, if the outcome of an action is better than its expected value, a positive RPE occurs which drives an increase in the expected value and future likelihood of selecting that particular action. Conversely, if the outcome is worse than expected, a negative RPE diminishes the expected value and likelihood of selecting that action. Phasic dopaminergic signaling in the VTA and striatum is consistent with encoding of a RPE [@Glimcher2011-ni], and dopaminergic activity has been implicated in reward based motor learning [@Galea2013-mp; @Pekny2015-re].

EEG has been used to identify neural correlates of error monitoring, but few studies have employed motor adaptation tasks. An event-related potential (ERP) known as the feedback related negativity (FRN) has been proposed to reflect processing of RPE in the context of reinforcement learning. There is evidence that FRN reflects activity in anterior cingulate or supplementary motor cortical areas, and the reinforcement learning theory of the FRN states that it is driven by phasic dopaminergic signaling of RPE [@Holroyd2002-hx; @Nieuwenhuis2004-ht; @Walsh2012-rk; @Heydari2016-fz]. Other accounts attribute the FRN to processes involving conflict monitoring or general prediction error as opposed to RPE. Motor adaptation paradigms are particularly opportune to test the reinforcement learning theory of the FRN as they afford dissociation between reinforcement learning processes and learning through sensory prediction error. 

The FRN potential is superimposed on the P300, a well characterized positive ERP component that peaks later than FRN, and with a more posterior scalp distribution. It has been proposed that the P300 reflects the updating of a model of stimulus context [@Donchin1988-gy]. Both the FRN and the P300 have been observed in response to errors in motor tasks. In this paper we describe experiments in which we isolated and compared EEG responses to both RPE and SPE using separate adaptation paradigms that produced comparable changes in behavior. We tested the idea that the FRN is a neural signature of RPE during reward based motor learning while the P300 reflects a process which is generally related to processing of prediction error but is particularly important for sensory error based learning.
 
# Materials and Methods

**Experimental Design and Statistical Analysis**. Participants underwent alternating experimental blocks of a reward learning task and a visuomotor rotation task. The design for each task is described under "reward learning task" and "visuomotor rotation task" methods subsections, respectively. Results of statistical tests are reported in the Results section, under "Behavioral Results", "Feedback Related Negativity Results", and "P300 Results". T-tests and Pearson's linear correlation tests were performed using MATLAB R2016b, and repeated measures analyses of variance (ANOVAs) were conducted using IBM SPSS Statistics version 25. For all ANOVAs, Mauchly's test was used to validate the assumption of sphericity.
 
**Participants**. A total of n=20 healthy, right-handed participants were included in our study (23.21 $\pm$ 3.09 years old, 12 females). Three participants underwent the experimental procedure but were excluded due to malfunction of the EEG recording equipment. One participant who reported that they performed movements based on a complex strategy that was unrelated to the experimental task was excluded. Participants provided written informed consent to experimental procedures approved by the Research Ethics Board at The University of Western Ontario.
 
**Experimental Procedure**. Participants first performed a block of 50 practice trials. After the practice block the experimenter fitted the EEG cap and applied conductive gel to the electrodes before beginning the behavioral task (see "EEG Data Acquisition" below). The behavioral task consisted of 8 experimental blocks, including four 115-trial blocks of a reward learning task and four 125-trial blocks of a visuomotor rotation task. The order of the blocks alternated between the two task types but was otherwise randomized. Participants took self-paced rests between blocks.

**Apparatus/Behavioral Task**. Participants produced reaching movements with their right arm in a horizontal plane at chest height while holding the handle of a robotic arm (InMotion2, Interactive Motion Technologies, Massachusetts, United States; Fig 1). Position of the robot handle was sampled at 600 Hz. A semi-silvered mirror obscured vision of the arm and displayed visual information related to the task. An air-sled supported each participant's right arm.

![Experimental setup. A, Participants reached to visual targets while holding the handle of a robotic arm. Vision of the arm was obscured by a screen that displayed visual information related to the task. B, During reaches, hand position was hidden but an arc shaped cursor indicated the extent of the reach without revealing reach angle. Feedback was provided at reach endpoint. C, In the reward learning condition, binary feedback represented whether reaches were successful or unsuccessful in hitting the target by turning green or red, respectively. Reach adaptation was induced by providing reward for movements that did not necessarily correspond to the visual target. D, In the visuomotor rotation condition, feedback represented the endpoint position of the hand. Adaptation was induced by rotating the angle of the feedback relative to the actual reach angle.](figures/fig1.eps){width=3.5in}

Participants began each trial with their hand at a start position in front of their chest at body midline (mid-saggital plane). The start position was displayed using a red circle with a diameter of 1 cm (Fig 1a). A white circular target was displayed 14 cm away from the start position (Fig 1a). A cursor indicated hand position only while the hand was within the start circle. The start position turned green to cue the onset of each reach once the handle had remained inside the start position continuously for 750 ms. Participants were instructed that they must wait for the cue to begin each reach, but that it was not necessary to reach immediately or react quickly upon seeing the cue.

Participants were instructed to make forward reaches and to stop their hand within the target. An arc shaped cursor indicated reach extent throughout the movement, without revealing the angle of the hand relative to the start position. In the first 5 baseline trials of each block, continuous position feedback was provided and consisted of an additional circular cursor indicated the position of the hand throughout the reach. In all subsequent reaches for each block, the cursor indicating hand position disappeared when the hand left the start position, and only the arc shaped cursor indicating movement extent was shown. A viscous force field assisted participants in braking their hand when the reach extent was greater than 14 cm.

The robot ended each movement by fixing the handle position when the hand velocity decreased below 0.03 m/s. During this time, while the hand was fixed in place (for 700 ms) visual feedback of hand position was provided. Feedback indicated either reach endpoint position, a binary reward outcome, or feedback of movement speed (see below). Visual feedback was then removed and the robot guided the hand back to the start position. During this time no visual information relating to hand position was displayed.

Reach endpoint was defined as the position at which the reach path intersected the perimeter of a circle (14 cm radius), centered at the start position. Reach angle was calculated as the angle between a line drawn from the start position to reach endpoint and a line drawn from the start position to the center of the target, such that reaching straight ahead corresponds to 0 deg and counter-clockwise reach angles are positive (Fig 1a). Feedback about reach angle was provided either in the form of endpoint position feedback or binary reward feedback. The type of feedback, as well as various feedback manipulations, varied according to the assigned experimental block type (See "Reward Learning Condition" and "Visuomotor Rotation Condition"). Endpoint position feedback consisted of a stationary cursor indicating the position of movement endpoint, while reward feedback consisted of the target turning either red or green to indicate that the reach endpoint missed or hit the target, respectively.

Movement duration was defined as the time elapsed between the hand leaving the start position and the moment hand velocity dropped below 0.03 m/s. If movement duration was greater than 700 ms or less than 450 ms no feedback pertaining to movement angle was provided. Instead, the gray arc behind the target turned blue or yellow to indicate that the reach was too slow or too fast, respectively. Participants were informed that movements with an incorrect speed would be repeated but would not otherwise affect the experiment.

To minimize the impact of eye-blink related EEG artifacts, participants were asked to fixate their gaze on a black circular target in the center of the reach target and to refrain from blinking throughout each arm movement and subsequent presentation of feedback.
 
**Practice Block**. Each participant completed a block of practice trials before undergoing the reward learning and visuomotor rotation experiments. Practice continued until participants achieved 50 movements within the desired range of movement duration. Continuous position feedback was provided during the first five trials, and only endpoint position feedback was provided for the subsequent 10 trials. After these initial 15 trials, no position feedback was provided outside the start position.

**Reward Learning Task**. Binary reward feedback was provided to induce adaptation of reach angle. Each participant completed 4 blocks in the reward learning condition. We manipulated feedback with direction of intended learning and reward probability as factors using a 2x2 design (direction of learning x reward probability) across blocks. For each direction of intended learning (clockwise and counter-clockwise), each participant experienced a block with high reward probability and a block with low reward probability. Each reward learning block continued until the participant completed 115 reaches with acceptable movement duration. Participants reached towards a circular target 1.2 cm (4.9 deg) in diameter. The first 15 reaches were baseline trials during which the participant did not receive reward feedback. Continuous position feedback was provided during the first five trials, and only endpoint position feedback was provided for the subsequent 10 trials. After these baseline trials, no position feedback was provided, and binary reward feedback was provided at the end of the movement. Participants were told that they would earn additional monetary compensation for reaches that ended within the target, up to a maximum of CAD$10 for the whole experiment. Participants were told that rewarded and unrewarded reaches would be indicated by the target turning green and red, respectively.

Unbeknownst to participants, reward feedback was delivered probabilistically. The likelihood of reward depended on the difference between the current reach angle and the median reach angle of the previous 10 reaches. In the high reward probability condition, reward was delivered with probability of 100% if the difference between the current reach angle and the running median was in the direction of intended learning, and at a probability of 30% otherwise ([@eq:phigh]). When the running median was at least 6 deg away from zero in the direction of intended learning, reward was delivered at a fixed probability of 65%. This was intended to minimize conscious awareness of the manipulation by limiting adaptation to $\pm$ 6 deg. In the low reward probability condition, reward was similarly delivered at a probability of either 70% or 0% ([@eq:plow]). When the running median was at least 6 deg away from zero in the direction of intended learning, reward was delivered at a fixed probability of 35%. Reach angle and feedback throughout a representative experimental block is shown in Figure 2.

![Reach angles of a representative participant. A) We show the reward learning block assigned to the clockwise adaptation with high reward probability condition. Reaches were rewarded with 100.0% probability for reach angles less than the median of the previous 10 reaches, and with 30.0% probability for reach angles greater than this running median. Reward was delivered at a fixed probability of 65.0% when the running median was less than -6 degs. B) The visuomotor rotation block assigned to the 1.5 degree rotation condition is shown. The rotation is imposed randomly in 50% of trials. The rotation is initially counterclockwise but reverses when the mean of the previous five reach angles becomes less than -6.0 deg.](figures/fig2.eps){width=5.0in}


$$
p_{high} =
\begin{cases}
1, & z \cdot (\theta_{i} - \text{median}(\theta_{i-10}, \dots, \theta_{i-1})) > 0 \\
.3, & z \cdot (\theta_{i} - \text{median}(\theta_{i-10}, \dots, \theta_{i-1})) < 0 \\
.65, & z \cdot \text{median}(\theta_{i-9}, \dots, \theta_{i}) > 6
\end{cases}
$${#eq:phigh}

$$
p_{low} =
\begin{cases}
.7, & z \cdot (\theta_{i} - \text{median}(\theta_{i-10}, \dots, \theta_{i-1})) > 0 \\
0, & z \cdot (\theta_{i} - \text{median}(\theta_{i-10}, \dots, \theta_{i-1})) < 0 \\
.35, & z \cdot \text{median}(\theta_{i-9}, \dots, \theta_{i}) > 6
\end{cases}
$${#eq:plow}

Where $p$ is probability of reward described separately for the high and low reward probability conditions, $\theta$ is the reach angle on trial $i$, $z=1$ for counter-clockwise learning blocks, and $z=-1$ for clockwise learning blocks.
 
**Visuomotor Rotation Task**. Endpoint feedback was rotated relative to the actual reach angle to induce sensory-error based adaptation. Each participant completed 4 blocks in the visuomotor rotation condition. We manipulated feedback with initial rotation direction and perturbation size as factors using a 2x2 design across blocks. For each direction of initial rotation (clockwise and counter-clockwise) each participant experienced a block with large rotation (1.5 deg) and a block with small rotation (.75 deg). Each block continued until participants completed 125 reaches within acceptable movement duration limits. Participants reached towards a circular target 2.5 cm (10.2 deg) in diameter. Participants first performed 25 baseline reaches during which position feedback reflected veridical reach angle. A cursor continuously indicated hand position during the first 10 trials. A static cursor indicated movement endpoint position for the subsequent 15 trials. After the baseline reaches, the adaptation portion of each block began unannounced to participants and continued until the participant performed 100 additional reaches of acceptable movement duration.

During the adaptation trials, endpoint position feedback was provided that did not necessarily correspond to the true hand position. Participants were instructed that endpoint feedback within the target would earn them bonus compensation, but no explicit reward feedback was provided. In a randomly selected 50% of trials, a rotation of 0.75 deg or 1.5 deg was imposed in the small and large perturbation conditions, respectively. In addition to adding a fixed rotation to the feedback angle in 50% of trials, we subtracted an estimate of the current state of reach adaptation from the feedback angle for every trial ([@eq:reachadapt]). This accounted for behavioral adaptation, allowing us to keep the average visual error size in the unperturbed and perturbed trials approximately constant throughout the experiment, despite participants adapting their reach angle to counteract the perturbations.

The online estimate of adaptation consisted of a running average of the previous 6 reach angles and a model of reach adaptation which assumed that participants would adapt to a fixed proportion of the reach errors experienced during the previous 3 trials. A windowed average centered around the current reach angle could serve as a low pass filter to estimate the current state of reach adaptation, but the running average during the experiment was necessarily centered behind the current reach angle. Thus, an online model was necessary to account for adaptation that would occur in response to errors experienced on trials included in the running average. Misestimation of the learning rate in the online model would lead to systematic bias in the feedback angle, while a perfect model would lead to unperturbed feedback that is distributed around 0 deg with variance that reflects the natural movement variability. Thus, an adaptation rate of 0.25 was chosen for the online model on the basis of pilot data, as we found that it resulted in a mean visual error of approximately zero in non-rotated trials.

As in the reward learning condition, we sought to limit the magnitude of adaptation to 6 deg in an attempt to minimize conscious awareness of the manipulation. This limit was implemented by reversing the direction of the perturbation whenever the average reach angle in the previous six movements differed from zero by at least 6 deg in the direction of intended reach adaptation. Reversing the direction of the perturbation caused participants to adapt in the opposite direction. Reach angle and feedback angle throughout a representative experimental block is shown in Figure 2.

$$
\begin{aligned}
X_{i} &= \theta_{i} + q - \text{mean}(\theta_{i-6}, \dots, \theta_{i-1}) + \sum^{i-1}_{k=i-3} (.25 \cdot x_{k}) \\
q &= z \cdot s \cdot u \\
p(u) &= \begin{cases}
   .5, & \text{if } u=1 \\
   .5, & \text{if } u=0
\end{cases}\\
\end{aligned}
$${#eq:reachadapt}

Where $X$ denotes feedback angle, $\theta$ denotes reach angle, and $q$ denotes perturbation. $z$ denotes the direction of the perturbation ($z=1$ for counter-clockwise perturbations, and $z=-1$ for clockwise perturbations). $s$ denotes the size of the perturbation (.75 deg or 1.5 deg in the small and large error conditions, respectively). $u$ is a discrete random variable that is realized as either 1 or 0 with equal probability (50%).
 
**EEG Data Acquisition**. EEG data were acquired from 16 cap-mounted electrodes using an active electrode system (g.Gamma; g.tec Medical Engineering) and amplifier (g.USBamp; g.tec Medical Engineering). We recorded from electrodes placed according to the 10-20 system at sites Fz, FCz, Cz, CPz, Pz, POz, FP1, FP2, FT9, FT10, FC1, FC2, F3, F4, F7, F8, referenced to an electrode placed on participants' left earlobe. Impedances were maintained below 5 kU. Data were sampled at 4800 Hz and filtered online with band-pass (0.1–1,000 Hz) and notch (60 Hz) filters. The amplifier also recorded data from a photo-diode attached to the display monitor to determine the timing of stimulus onset.

**Behavioral Data Analysis**. *Reward learning task*: Motor learning scores were calculated for each participant as the difference between the average reach angle in the counter-clockwise learning blocks and the average reach angle in the clockwise learning blocks. We excluded baseline trials and trials that did not meet the movement duration criteria, as no feedback related to reach angle was provided on these trials (6.5% of trials in the VMR task, 7.4% OF trials in the RL task.)

*Visuomotor rotation task*: To quantify trial-by-trial learning we first calculated the change in reach angle between successive trials, as in [@eq:vmr].

$$
\Delta\theta_{i} = \theta_{i+1} - \theta_{i}
$${#eq:vmr}

We then performed a linear regression on $\Delta\theta_{i}$ with the rotation imposed on the preceding trial as the predictor variable. The rotation was either 0, $\pm$ 0.75, or $\pm$ 1.5 deg. This regression was performed on an individual participant basis, using the data from the adaptation portion of all four visuomotor rotation blocks. We excluded trials that did not meet the duration criteria or that resulted in a visual error of greater than 10 deg (M=2.65 trials per participant, SD=4.3), as these large errors were thought to reflect execution errors or otherwise atypical movements. We took the resulting slope estimate, multiplied by -1, as a metric of learning rate for each participant, as it reflects the portion of visual errors that participants corrected with a trial-by-trial adaptive process. 
 
**EEG Data Denoising**. EEG data were resampled to 480 Hz and filtered offline between 0.1-35 Hz using a second order Butterworth filter. Continuous data were segmented into 2 second epochs time-locked to feedback stimulus onset at 0 ms (time range: -500 to +1500 ms). Epochs containing artifacts were removed using a semi-automatic algorithm for artifact rejection in the EEGLAB toolbox (see @Delorme2004-ca for details). Epochs flagged for containing artifacts as well as any channels with bad recordings were removed after visual inspection. Subsequently, extended infomax independent component analysis was performed on each participant's data [@Delorme2004-ca]. Components reflecting eye movements and blink artifacts were identified by visual inspection and subtracted by projection of the remaining components back to the voltage time series. 
 
**Event Related Component Averaging**. We computed event related potentials (ERPs) on an individual participant basis by trial averaging EEG time series epochs after artifact removal. We selected trials corresponding to various feedback conditions in each task as described in the following sections. For each feedback condition ERPs were computed on an individual participant basis separately for recordings from channels FCz and Pz. All ERPs were baseline corrected by subtracting the average voltage in the 75 ms period immediately following stimulus onset. We chose to use a baseline period following, as opposed to preceding, stimulus onset because stimuli were presented immediately upon movement termination, and the period before stimulus presentation was more likely to be affected by movement related artifacts. Importantly, we did not observe any ERPs with onsets within the baseline period. Trials in which reaches did not meet the movement duration criteria were excluded, as feedback relevant to reach adaptation was not provided on these trials.
 
*Reward Learning Task*: ERPs from the reward learning condition were used to examine the neural correlates of RPE. We computed ERPs separately for feedback conditions corresponding to "expected reward", "unexpected reward", "expected non-reward", and "unexpected non-reward". Expectancy was determined on the basis of the reward probability condition: reward in the high reward probability and non-reward in the low reward probability conditions were deemed expected, while reward in the low reward probability and non-reward in the high reward probability conditions were deemed unexpected [@Holroyd2007-it].
 
*Visuomotor Rotation Task*: ERPs elicited by visuomotor rotation were used to examine the neural correlates of SPE. We created trial averaged ERP responses for trials with rotated feedback and trials with non-rotated feedback separately for the 0.75 deg and 1.5 deg rotation conditions. Size of rotation was varied across blocks, while within each block rotations were imposed in a randomly selected 50% of trials. The resulting ERPs are identified by the conditions "rotated 0.75 deg", "non-rotated 0.75 deg", "rotated 1.5 degs" and "non-rotated 1.5 deg".

In order to test for effects of absolute endpoint error, which is determined not only by visuomotor rotation but also movement execution errors, we sorted trials in the adaptation portion of the visuomotor rotation blocks by the absolute value of the angle of visual feedback relative to the center of the target. We created "most accurate" ERPs for each participant by selecting the 75 trials with the smallest absolute feedback angle, and "least accurate" ERPs by selecting the 75 trials with the largest absolute feedback angle.

We computed ERPs to test a correlation, across participants, between behavioral learning rate and the average neural response to feedback during adaptation to visuomotor rotation. These ERPs, labelled as belonging to the "adaptation" condition, included all trials in the "rotated 0.75 deg", "non-rotated 0.75 deg", "rotated 1.5 degs" and "non-rotated 1.5 deg" conditions.
 
## Feedback Related Negativity Analysis

The FRN was analyzed using a difference wave approach with ERPs recorded from FCz, where it is typically largest [@Holroyd2007-it]. By computing a difference wave between non reward and reward outcomes, it is possible to capture a bidirectional voltage response to reward vs non reward feedback. Although the feedback related negativity is classically characterized by a negative voltage peak following non reward feedback, multiple lines of evidence suggest that voltage increase in response to reward outcomes also contributes to the variance captured by the difference wave approach, despite not producing a distinct peak [@Baker2011-kv; @Carlson2011-uv; @Walsh2012-rk; @Becker2014-zi; @Heydari2016-fz]. Furthermore, difference waves can be computed separately for expected and unexpected outcomes, capturing effects related to reward prediction error while removing effects of pure surprise through subtraction. Difference waves were computed for each participant by subtracting ERPs corresponding to unsuccessful outcomes from those corresponding to successful outcomes. FRN amplitude was determined as the mean value of the difference wave between 200-350 ms after feedback presentation. This time window was chosen a priori on the basis of previous reports [@Walsh2012-rk]. To test for the statistically significant presence of the FRN for each difference wave, we submitted the mean value between 200-350 ms after feedback presentation to a one sample t-test against zero.

*Visuomotor Rotation Task*: First, we created difference waves to test whether the rotations imposed on randomly selected trials elicited FRN. The "rotated 0.75 deg" ERPs were subtracted from the "non-rotated 0.75 deg" ERPs to create a "small VMR" difference wave. The "rotated 1.5 deg" ERPs were subtracted from the "non-rotated 1.5 deg" ERPs to create a "large VMR" difference wave.

Next, we created a difference wave to test whether a FRN was observable by comparing trials where the endpoint feedback was furthest from the center of the target from those where feedback was closest to the center of the target. The "least accurate" ERPs were subtracted from the "most accurate" ERPs to create an "endpoint error" difference wave. We hypothesized that sensory error feedback would not elicit a FRN, and as such we tested for the FRN using this second approach to more thoroughly confirm our hypothesis that the FRN would not be observed in the visuomotor rotation task. 

*Reward Learning Task*:  The expected non-reward ERP was subtracted from the expected reward EPR to create an "expected" difference wave, and the unexpected non-reward ERP was subtracted from the unexpected reward EPR to create an "unexpected" difference wave.

We used a paired t-test to test the difference between peak FRN amplitude for the "expected" and "unexpected" difference waves. 

## P300 analysis

To analyze the P300 we used ERPs recorded from channel Pz, where it is typically largest [@Fabiani1987-sk; @Hajcak2005-kk; @Polich2007-nf; @MacLean2015-sv]. We calculated P300 amplitude using base-to-peak voltage difference. The temporal ROIs for the peak and base were determined using grand averages computed across participants and conditions for each task (see "Visuomotor Rotation task", and "Reward Learning Task", below). P300 peak was defined as the maximum peak occurring 250-500 ms after stimulus onset, which always corresponded to the largest peak in the analyzed epoch. P300 base was defined as the minimum preceding peak that occurred at least 100 ms after stimulus onset. For each subject, peak and base voltages were calculated separately for each condition ERP as the average voltage within 50 ms windows centered around the temporal ROIs defined at the group level. P300 amplitude was then determined as the difference between peak and base voltage.

*Visuomotor Rotation task*: P300 amplitude was calculated in four conditions using the "rotated 0.75 deg", "non-rotated 0.75 deg", "rotated 1.5 deg" and "non-rotated 1.5 deg", ERPs. Temporal ROIs were determined, as described above, by aggregating all trials across participants and the four conditions into a single set and averaging to produce an "aggregate grand average from trials" waveform. This approach allows for data driven ROI selection without inflated Type-I error rate, and has been shown to be insensitive to trial number asymmetry across conditions [@Brooks2017-ev]. We tested for differences in P300 amplitude related to visuomotor rotation using two-way repeated measures ANOVA with factors rotation (levels: non-rotated, rotated) and rotation magnitude (levels: 0.75 deg, 1.5 deg). 

*Reward Learning Task*: P300 amplitude was calculated in four conditions using the "unexpected reward", "expected reward", "unexpected non-reward", and "expected non-reward" feedback condition ERPs, described above. We found that the waveform morphology was considerably different for the ERPs elicited by reward feedback and those elicited by non-reward feedback, in part due to the feedback related negativity. As such we defined temporal ROIs separately for the reward conditions  (unexpected reward, expected reward) and the non-reward conditions ("unexpected non-reward", and "expected non-reward"). In both cases, temporal ROIs were determined, as described above, by aggregating all trials across participants and the corresponding two conditions into a single set and averaging to produce an "aggregate grand average from trials" waveform. This ROI selection method has only been shown to be necessarily unbiased when all conditions display similar waveform morphology and are grouped together [@Brooks2017-ev]. For this reason, we repeated our analysis using a common method of selecting peaks for each individual participant and condition ERP after matching the number of trials across conditions, which produced similar results.

We tested for differences in P300 amplitude between feedback conditions using 2 way repeated measures ANOVA with factors reward (levels: rewarded, non-rewarded) and expectancy (levels: unexpected, expected).

# Results

## Behavioral Results

*Reward Learning Task*. In the reward learning task participants adapted their reach angle on the basis of binary reward feedback (Fig 3). We calculated a reward learning score for each subject by subtracting the average reach angle in the clockwise learning condition from that in the counterclockwise learning condition, excluding the baseline trials, such that the average reward learning score would be approximately zero if participants did not respond to the reward feedback in any way. We observed a mean reward learning score of 5.47 (SD=4.66), which is significantly greater than zero (one-sample t-test; t(19)=5.25, p<.001). Participants received reward on 67.0% (SD=4.9%) of trials in the high probability condition and 38.6% (SD=4.3%) of trials in the low probability condition.

![Participants adapted their reach angle in the reward learning condition. Group average reach angles in the reward learning conditions are plotted. Each participant completed four blocks. For each direction of intended learning (clockwise and counter clockwise), each participant completed a block in the high reward probability (35%) condition and a block in the low reward probability (65%) condition. Shaded regions are $\pm$ 1 SEM.](figures/fig3.eps){width=5.0in}

*Visuomotor rotation task*. In the visuomotor rotation task participants received endpoint cursor feedback and adapted their reach angles in response to the rotated cursor feedback imposed on randomly selected trials. To estimate trial-by-trial learning rates for individual participants we quantified the linear relationship between the change in reach angle after each trial with the rotation imposed on the preceding trial as the predictor variable. We took the resulting slope estimate and multiplied it by negative one to obtain a measure of learning rate. This metric reflects the proportion of visuomotor rotation that each participant corrected with a trial-by-trial adaptive process. The mean learning rate was 0.33 (SD=0.15), which  was significantly different from zero (one-sample t-test; t(19)=9.90, p<.001). This indicates that participants corrected for visual errors on a trial-by-trial basis. Figure 4 shows the average change in reach angle for each size and direction of the imposed cursor rotation.

![Participants adapted their reach angle on a trial-by-trial basis in the visuomotor rotation condition. The average change in reach angle between subsequent pairs of trials is plotted for each size and direction of rotation imposed on the preceding trial. The average change in reach angle is in all cases opposite to the rotation, indicating that participants adapted their reaches to counteract the perturbations.](figures/fig4.eps){width=2.5in}

## Feedback Related Negativity Results

*Reward learning task*. Figure 5a shows the ERPs recorded from electrode FCz during the reward learning condition, averaged across participants. The mean value of the "expected" difference wave recorded from FCz between 200-350 ms was significantly different from zero (M=5.34 µv, SD=4.11, t(19)=5.81, p<.001, one-sample t-test), indicating that expected feedback elicited a FRN in our reward learning task. The mean value of the "unexpected" difference wave was also significantly larger than zero (M=7.09 µv, SD=2.76, t(19)=11.47, p<.001, one-sample t-test), indicating that unexpected feedback also elicited a FRN.

![The feedback related negativity reflects reward prediction error during the reward learning task.  A, Trial averaged ERPs recorded from electrode FCz aligned to feedback presentation (0 ms: vertical blue line). Expected and unexpected reward reflects reward feedback in the high and low reward probability conditions, respectively. Expected and unexpected non-reward refers to non-reward feedback in the low and high reward probability conditions, respectively. B, The mean amplitude of the difference wave (reward ERP – non-reward ERP) between 200-350ms for unexpected and expected feedback (Error bars: $\pm$ SEM). The mean amplitudes of the difference waves are correlated to behavioral learning scores across participants for the expected feedback, but not the unexpected feedback.](figures/fig5.eps){width=4.5in}

The mean amplitude of the "unexpected" difference wave was not reliably larger than the mean amplitude of the "expected" difference wave, although the difference showed a nearly significant trend in this direction  (t(19)=1.66, p=.056, paired t-test, one-tailed; Fig 5b). "Expected" difference wave amplitude was significantly correlated to reward learning scores, which we calculated for each subject as the difference in average reach angle between the clockwise and counterclockwise learning conditions (r=.518, p=.018; Fig 5b). The "unexpected" difference wave amplitude was not correlated to reward learning scores (r=-0.187, p=.43; Fig 5b).

*Visuomotor rotation task*. Figure 6a shows the ERPs recorded from electrode FCz during the visuomotor rotation condition, averaged across participants. The mean value of the "small VMR" difference wave recorded from FCz between 200-350 ms was not significantly different from zero (M=-0.21 µv, SD=1.29, t(19)=-0.73, p=0.48, one-sample t-test, Fig. 6b). Similarly, the mean value of the "large VMR" difference wave recorded from FCz between 200-350 ms was not significantly different than zero (M=-0.26 µv, SD=1.22, t(19)=-0.97, p=0.34, one-sample t-test, Fig. 6b). These findings indicate that the VMRs imposed in the visuomotor rotation task did not reliably elicit a FRN.

![The feedback related negativity was not elicited by sensory prediction error during the visuomotor rotation task. A, Trial averaged ERPs recorded from electrode FCz aligned to feedback presentation (0 ms: vertical line). B, The mean amplitude of the difference wave (non rotated ERP – rotated ERP) between 200-350ms for the .75 and 1.5 degree rotation condition (Error bars: $\pm$ SEM).](figures/fig6.eps){width=5.5in}

The mean value of the "endpoint error" difference wave recorded from FCz between 200-350 ms was not significantly different than zero (M=0.61 µv, SD=3.28, t(19)=0.82, p=.42, one-sample t-test), indicating that a FRN did not reliably occur on the basis of endpoint error feedback. The fact that we were able to detect a FRN in the reward learning task but not in the visuomotor rotation task is consistent with the notion that the FRN reflects RPE, and that our experimental design successfully dissociated RPE from SPE.

## P300 Results

![The P300 is modulated by feedback during the reward learning task. A, Trial averaged ERPs recorded from electrode Pz aligned to feedback presentation (0 ms: vertical line). B, P300 amplitude in each feedback condition (Error bars: $\pm$ SEM). P300 amplitude is larger for rewarded feedback relative to unrewarded feedback, and unexpected feedback relative to expected feedback.
](figures/fig7.eps){width=4.0in}

*Reward learning task*. Figure 7A shows ERPs recorded from electrode Pz during the reward learning condition, averaged across participants. We performed a 2x2 repeated measures ANOVA on P300 amplitude with factors expectancy and reward. Figure 7b shows P300 amplitude for each condition, averaged across participants  We found a significant main effect of feedback expectancy (F(1,19)=97.16,p<.001), indicating that P300 amplitude was significantly larger in the unexpected feedback conditions. We also found a significant main effect of reward, (F(1,19)=13.18, p=.002), indicating P300 amplitude was larger following rewarded trials compared to unrewarded trials. We found no reliable interaction between reward and expectancy, (F(1,19)=0.992, p=.332). P300 amplitude was not significantly correlated to reward learning scores for any of the four feedback conditions: expected reward (r=0.17, p=0.47), unexpected reward (r=0.07, p=.78), expected non-reward (r=-0.02, p=.92), and unexpected non-reward (r=0.10, p=.67).

![The P300 reflects sensory error processing during the visuomotor rotation task.  A, Trial average ERPs recorded from electrode Pz aligned to feedback presentation (0 ms).  B, The peak-to-peak amplitude of the P300 during the visuomotor rotation task (Error bars: $\pm$ SEM). C, P300 amplitude during adaptation was correlated to learning rate. *: p < .05, **: p < .01. D, P300 amplitude was larger for rotated than non-rotated trials in the 1.5 deg rotation condition but not the .75 deg rotation condition.](figures/fig8.eps){width=4.5in}

*Visuomotor rotation task*. Figure 8a shows ERPs recorded from electrode Pz during the visuomotor rotation task, averaged across participants. We first-tested for an effect of the visuomotor rotation on P300 amplitude by comparing non-rotated feedback trials and rotated feedback trials. We performed a two-way repeated measures ANOVA with factors presence of rotation and size of rotation (Figure 8b). We did not find significant main effects of presence of rotation (F(1,19)=2.917, p=.104). We also did not find a main effect of size of rotation (F(1,19)=3.087, p=.095). We did find a significant interaction effect between presence of rotation and rotation magnitude (F(1,19)=8.728, p=.008). We performed planned pairwise comparisons using Bonferroni corrected t-tests between non-rotated and rotated conditions separately for the small and large error conditions. We found that P300 amplitude was significantly greater for rotated, compared to non-rotated, feedback in the 1.5 deg rotation condition (t(19)= 2.83, p=0.021, Bonferroni corrected), but not the .75 deg rotation condition (t(19)=0.09, p=0.93).

We also found a significant correlation between behavioral learning rate and the P300 amplitude measured in the "adaptation" condition ERPs (r=.50, p=0.025; Fig 8b).

# Discussion

We observed neural correlates of RPE and SPE during motor adaptation in reaching tasks that were designed to isolate each response while producing comparable changes in reach angle. In both tasks, learning occurred in response to discrete feedback shown after each movement. By examining ERPs elicited by feedback delivered at the end of movement we avoided potential confounds caused by neural activity or artifacts related to movement execution, motion of the limb, and online error correction. We observed that the feedback related negativity (FRN) encoded RPE in response to binary reward feedback but was not elicited by sensory error feedback. This suggests that the process generating the FRN is not necessary for sensory error based learning, and supports the idea that the processes underlying the FRN are specific to reinforcement learning. The P300 occurred in response to both reinforcement and sensory error feedback, and P300 amplitude was modulated by visuomotor rotation, reward, and surprise. In the visuomotor rotation task, P300 amplitude depended on the size of SPE, and was correlated to learning rate across participants. This suggests that the P300 might reflect general processing of prediction error that is particularly important for sensory error based motor adaptation.
 
## The FRN Encoded Reward Prediction Error in Reward Based but not Sensory Error Based Motor Adaptation

Although motor adaptation has traditionally focused on sensory error learning, recent work suggests that reinforcement learning processes can also contribute to motor adaptation. In the present study, RPE was isolated from SPE during the reward learning task by providing only binary reward feedback in the absence of visual information concerning the position of the hand relative to the target. This feedback elicited a well characterized fronto-central ERP component known as the FRN.

In reinforcement learning theory, RPE is the difference between the observed outcome value and the expected value. The expected value of an action is equal to the product of reward magnitude and the probability of reward. In our reward learning task the reward magnitude was fixed, and thus can be represented as a binary quantity (0 or 1), and so the expected value of a particular action on each trial (e.g. the direction of hand movement) was directly proportional to the probability of reward. Therefore, reward feedback should always elicit a positive RPE with increasing magnitude when reward is less probable. Conversely, non-reward should always elicit negative RPE with increasing magnitude when reward is more probable.

The FRN was observed in the reward learning task as a difference in voltage between ERPs elicited by non-reward feedback and those elicited by reward feedback. A large body of literature has shown that the FRN is larger for unexpected outcomes than expected outcomes, which supports the theory that the FRN encodes a signed RPE [@Cohen2007-oa; @Holroyd2007-it; @Eppinger2008-gr; @Holroyd2011-ib; @Kreussel2012-mi; @Walsh2012-rk]. In the present study, the FRN was larger for improbable feedback than for probable feedback, although the difference was not statistically reliable (p=.056). This result is potentially due to the relatively small difference in reward probability experienced between the low and high reward probability conditions (38.6% and 67.0%, respectively) when compared to other studies. We decided to avoid using very low or very high reward probability as we found it to produce highly variable and strategic behavior in the task.

A prominent theory proposes that the FRN reflects activity originating in the anterior cingulate cortex driven by phasic dopaminergic signaling of RPE [@Holroyd2002-hx; @Santesso2009-zm]. This activity is purported to underlie reward-based learning processes by integrating RPE to affect future action selection. We sought to examine the role of the FRN in learning by testing the correlation between the amplitude of the FRN and the extent of learning as assessed behaviorally.

In typical reward learning paradigms, successful learning is correlated with increased reward probability, and as such the relationship between the FRN and the magnitude of learning is confounded by any effect of reward probability on FRN amplitude. In the current study, the reward learning task was adaptive to learning such that the overall reward probability was largely decoupled from the extent of adaptation. We found that the extent of behavioral learning was correlated to the peak amplitude of the FRN for the expected feedback condition but not the unexpected feedback condition. One possible explanation for this discrepancy is that participants responded reliably to the large RPEs elicited by unexpected feedback as they were most salient, but the limiting factor in learning was a sensitivity to small RPEs. Even though small RPEs should produce less learning per trial than large RPEs, in our task they were by definition more numerous and as such could contribute comparably to the overall extent of learning. Another possibility is that the measure of FRN amplitude became less reliable in the unexpected feedback condition due to interference by surprise related signals that were not directly related to RL, such as the P300. Relationships between the FRN and learning have been observed for tasks such as time estimation and discrete motor sequence learning [@Holroyd2007-it; @Van_der_Helden2010-eh]. As such, the present findings support the idea that the same RPE processing mechanism can drive learning across both cognitive and motor tasks.

In the present study the sensory error-based learning task allowed us to dissociate the neural signatures of RPE from those of SPE. SPE often coincides with RPE, as failure to achieve the expected sensory consequences of a motor command usually entails failure to achieve the subjective goal of the task. Our visuomotor rotation task was designed to elicit learning through SPE while minimizing RPE, as the perturbations were relatively small and rarely resulted in cursor feedback outside of the target. We did not observe the presence of the FRN in response to sensory error feedback, despite reliable observation of behavioural adaptation and the P300 neural response. This suggests that the process which generates the FRN is not necessary for adaptation to sensory errors. 

Our results suggest that the ERP responses to RPE and SPE can be dissociated in motor adaptation, and that the FRN is specific to reward based learning processes. Although the FRN is classically associated with reinforcement learning, recent work has identified the FRN or the closely related error-related negativity (ERN) in various motor learning and execution tasks involving sensory error signals. These studies either concluded that reinforcement and sensory error based learning processes share common neural resources, or they simply do not distinguish between these two processes [@Krigolson2008-dh; @Torrecillos2014-jd; @MacLean2015-sv]. We argue that the brain processes RPE and SPE through distinct mechanisms, but that the two processes can be confounded when perturbations causing a SPE are also evaluated as an implicit failure to meet task goals. In this case, the brain could process a RPE and a SPE independently, although learning might be driven primarily by the SPE. This is consistent with behavioral studies showing that sensory error based learning is the primary driver of behavioral change when both reward and sensory feedback is provided [@Izawa2011-ik; @Cashaback2017-oy].
 
## The P300 is Modulated by SPE, Surprise, and Reward

During the visuomotor rotation task in the present study, we observed a P300 ERP in response to reach endpoint position feedback, and we found that P300 amplitude was sensitive to the magnitude of SPE. P300 amplitude was increased by the larger but not the smaller visuomotor rotation. Learning in visuomotor rotation paradigms is thought to be driven primarily by SPE, and as such our findings suggest that the P300 observed in this task might reflect neural activity that is related to processing of SPE underlying motor adaptation [@Izawa2011-ik].

It is important to note that a P300 response is typically elicited by stimulus processing in tasks unrelated to sensory error-based motor adaptation, including the reward learning task in the present study. A prominent and enduring theory proposes that the P300 reflects cortical processing related to the updating of a neural model of stimulus context upon processing of unexpected stimuli [@Donchin1981-lj; @Donchin1988-gy; @Polich2007-nf]. This theory resembles an account of sensory error based motor adaptation in which the updating of an internal model of motor dynamics occurs when sensory input differs from the predictions of the internal model [@Wolpert1995-io; @Synofzik2008-sb]. It is possible that the P300 reflects a general aspect of prediction error processing that is common to both sensorimotor and cognitive function. The P300 is typically localized to parietal regions, which are implicated in processing SPE during adaptation to visuomotor rotation [@Bledowski2004-me; @Diedrichsen2005-wa; @Linden2005-jg; @Tanaka2009-gp]. Consistent with the P300 underlying SPE processing, cerebellar damage impairs sensory error based adaptation and results in P300 abnormalities [@Tachibana1995-xi; @Martin1996-rb; @Maschke2004-me; @Paulus2004-mi; @Smith2005-hp; @Mannarelli2015-fe].

Previous studies have examined P300 responses elicited by sensory error feedback. It has been demonstrated that P300 amplitude decreases along with the magnitude of reach errors during the course of prism adaptation [@MacLean2015-sv]. This suggests that the P300 is modulated by SPE, but it does not rule out the possibility that the P300 simply attenuated with time. The P300 has also been reported to occur in response to another type of visuo-spatial error—random shifts in target location [@Krigolson2008-dh], although learning does not reliably occur in response to random target errors [@Diedrichsen2005-wa]. Both of these studies also reported FRN components occurring in response to task errors. In the present study a P300 response was observed that is correlated to behavioral learning and isolated from the FRN.

In our reward learning task, P300 amplitude was modulated by feedback valence and expectancy but was not correlated to learning.The finding that P300 shows a larger positive amplitude for unexpected feedback regardless of valence is consistent with previous reports and supports the notion that the P300 reflects a general prediction error processing when the stimulus differs from expectation [@Hajcak2005-kk; @Hajcak2007-ov; @Wu2009-yv; @Pfabigan2011-jf]. This is distinct from the interaction between valence and expectancy that is characteristic of encoding RPE, in which surprise has opposite effects on the response to reward and non reward. We also found that the P300 was larger for reward than non reward feedback. Some previous studies have shown a similar effect of reward valence on P300 amplitude [@Hajcak2005-kk; @Wu2009-yv; @Leng2010-by; @Zhou2010-wb], while others have not [@Yeung2004-ft; @Sato2005-wj; @Pfabigan2011-jf]. This finding is also consistent with idea that the P300 reflects updating of a model of stimulus context in response to prediction error, as reward feedback would indicate that the previous action was rewarding while all other possible actions were not rewarding. Non reward feedback would only indicate that the previous action was not rewarding, and thus carries less information for updating of the internal representation of the task.

\newpage
# References
\singlespacing
\raggedright
